<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>WildBoottest - wildboottest</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "WildBoottest";
        var mkdocs_page_input_path = "base.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> wildboottest
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">WildBoottest</a>
    <ul class="current">
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../weights/">Weighting</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../library_apis/">Library APIs</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">wildboottest</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>WildBoottest</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/s3alfisc/wildboottest/edit/master/docs/base.md">Edit on s3alfisc/wildboottest</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="wild-cluster-bootstrap-class">Wild Cluster Bootstrap Class</h2>


<div class="doc doc-object doc-class">


<a id="wildboottest.wildboottest.WildboottestCL"></a>
  <div class="doc doc-contents first">

  
      <p>Create an object of WildboottestCL and get p-value by successively applying
methods in the following way: </p>

<details class="example">
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>import numpy as np
from wildboottest.wildboottest import WildboottestCL
np.random.seed(12312312)
N = 1000
k = 3
G = 10
X = np.random.normal(0, 1, N * k).reshape((N,k))
beta = np.random.normal(0,1,k)
beta[0] = 0.005
u = np.random.normal(0,1,N)
Y = 1 + X @ beta + u
cluster = np.random.choice(list(range(0,G)), N)
R = np.array([1, 0, 0])
B = 999</p>
<p>wb = WildboottestCL(X = X, Y = Y, cluster = cluster, R = R, B = B)
wb.get_scores(bootstrap_type = "11", impose_null = True)
wb.get_weights(weights_type= "rademacher")
wb.get_numer()
wb.get_denom()
wb.get_tboot()
wb.get_vcov()
wb.get_tstat()
wb.get_pvalue()</p>
</blockquote>
</blockquote>
</blockquote>
</details>

        <details class="quote">
          <summary>Source code in <code>wildboottest\wildboottest.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">WildboottestCL</span><span class="p">:</span> 
  <span class="sd">&quot;&quot;&quot;Create an object of WildboottestCL and get p-value by successively applying</span>
<span class="sd">  methods in the following way: </span>

<span class="sd">  Example:</span>

<span class="sd">      &gt;&gt;&gt; import numpy as np</span>
<span class="sd">      &gt;&gt;&gt; from wildboottest.wildboottest import WildboottestCL</span>
<span class="sd">      &gt;&gt;&gt; np.random.seed(12312312)</span>
<span class="sd">      &gt;&gt;&gt; N = 1000</span>
<span class="sd">      &gt;&gt;&gt; k = 3</span>
<span class="sd">      &gt;&gt;&gt; G = 10</span>
<span class="sd">      &gt;&gt;&gt; X = np.random.normal(0, 1, N * k).reshape((N,k))</span>
<span class="sd">      &gt;&gt;&gt; beta = np.random.normal(0,1,k)</span>
<span class="sd">      &gt;&gt;&gt; beta[0] = 0.005</span>
<span class="sd">      &gt;&gt;&gt; u = np.random.normal(0,1,N)</span>
<span class="sd">      &gt;&gt;&gt; Y = 1 + X @ beta + u</span>
<span class="sd">      &gt;&gt;&gt; cluster = np.random.choice(list(range(0,G)), N)</span>
<span class="sd">      &gt;&gt;&gt; R = np.array([1, 0, 0])</span>
<span class="sd">      &gt;&gt;&gt; B = 999</span>

<span class="sd">      &gt;&gt;&gt; wb = WildboottestCL(X = X, Y = Y, cluster = cluster, R = R, B = B)</span>
<span class="sd">      &gt;&gt;&gt; wb.get_scores(bootstrap_type = &quot;11&quot;, impose_null = True)</span>
<span class="sd">      &gt;&gt;&gt; wb.get_weights(weights_type= &quot;rademacher&quot;)</span>
<span class="sd">      &gt;&gt;&gt; wb.get_numer()</span>
<span class="sd">      &gt;&gt;&gt; wb.get_denom()</span>
<span class="sd">      &gt;&gt;&gt; wb.get_tboot()</span>
<span class="sd">      &gt;&gt;&gt; wb.get_vcov()</span>
<span class="sd">      &gt;&gt;&gt; wb.get_tstat()</span>
<span class="sd">      &gt;&gt;&gt; wb.get_pvalue()  </span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span> <span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">],</span> 
               <span class="n">Y</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">],</span> 
               <span class="n">cluster</span> <span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">],</span> 
               <span class="n">R</span> <span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> 
               <span class="n">B</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
               <span class="n">bootcluster</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
               <span class="n">seed</span><span class="p">:</span>  <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Initializes the Wild Cluster Bootstrap Class</span>

<span class="sd">    Args:</span>
<span class="sd">        X (Union[np.ndarray, pd.DataFrame, pd.Series]): Exogeneous variable array or dataframe</span>
<span class="sd">        Y (Union[np.ndarray, pd.DataFrame, pd.Series]): Endogenous variable array or dataframe</span>
<span class="sd">        cluster (Union[np.ndarray, pd.DataFrame, pd.Series]): Cluster array or dataframe</span>
<span class="sd">        R (Union[np.ndarray, pd.DataFrame]): Constraint matrix for running bootstrap</span>
<span class="sd">        B (int): bootstrap iterations</span>
<span class="sd">        bootcluster (Union[np.ndarray, pd.DataFrame, pd.Series, None], optional): Sub-cluster array. Defaults to None.</span>
<span class="sd">        seed (Union[int, None], optional): Random seed for random weight types. Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: Raise if input arrays are lists</span>
<span class="sd">        TestMatrixNonConformabilityException: Raise if constraint matrix shape does not conform to X</span>
<span class="sd">    &quot;&quot;&quot;</span>    

    <span class="s2">&quot;Initialize the WildboottestCL class&quot;</span>
    <span class="c1">#assert bootstrap_type in [&#39;11&#39;, &#39;13&#39;, &#39;31&#39;, &#39;33&#39;]</span>
    <span class="c1">#assert impose_null in [True, False]</span>

    <span class="k">if</span> <span class="n">bootcluster</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
      <span class="n">bootcluster</span> <span class="o">=</span> <span class="n">cluster</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">cluster</span><span class="p">,</span> <span class="n">bootcluster</span><span class="p">]:</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> cannot be a list&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">values</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">values</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cluster</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">clustid</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">cluster</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">values</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bootcluster</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span> <span class="o">=</span> <span class="n">bootcluster</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">bootcluster</span> <span class="o">=</span> <span class="n">bootcluster</span><span class="o">.</span><span class="n">values</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">clustid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">bootcluster</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">bootcluster</span> <span class="o">=</span> <span class="n">bootcluster</span>

    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
      <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">N_G_bootcluster</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">G</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clustid</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">B</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">R</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
      <span class="k">raise</span> <span class="n">TestMatrixNonConformabilityException</span><span class="p">(</span><span class="s2">&quot;The number of rows in the test matrix R, does not &quot;</span><span class="p">)</span>

    <span class="n">X_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tXgXg_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tXgyg_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tXX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>
    <span class="n">tXy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>

    <span class="c1">#all_cluster = np.unique(bootcluster)</span>

    <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">:</span>

      <span class="c1"># split X and Y by (boot)cluster</span>
      <span class="n">X_g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootcluster</span> <span class="o">==</span> <span class="n">g</span><span class="p">)]</span>
      <span class="n">Y_g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootcluster</span> <span class="o">==</span> <span class="n">g</span><span class="p">)]</span>
      <span class="n">tXgXg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">X_g</span><span class="p">)</span> <span class="o">@</span> <span class="n">X_g</span>
      <span class="n">tXgyg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">X_g</span><span class="p">)</span> <span class="o">@</span> <span class="n">Y_g</span>
      <span class="n">X_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_g</span><span class="p">)</span>
      <span class="n">y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y_g</span><span class="p">)</span>
      <span class="n">tXgXg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tXgXg</span><span class="p">)</span>
      <span class="n">tXgyg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tXgyg</span><span class="p">)</span>
      <span class="n">tXX</span> <span class="o">+=</span> <span class="n">tXgXg</span>
      <span class="n">tXy</span> <span class="o">+=</span> <span class="n">tXgyg</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">X_list</span> <span class="o">=</span> <span class="n">X_list</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Y_list</span> <span class="o">=</span> <span class="n">y_list</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tXgXg_list</span> <span class="o">=</span> <span class="n">tXgXg_list</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tXgyg_list</span> <span class="o">=</span> <span class="n">tXgyg_list</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tXX</span> <span class="o">=</span> <span class="n">tXX</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tXy</span> <span class="o">=</span> <span class="n">tXy</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">tXX</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">RtXXinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">get_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Function for getting weights for bootstrapping.</span>

<span class="sd">    Args:</span>
<span class="sd">        weights_type (Tuple[str, Callable]): The distribution to be used. Accepts Either &#39;rademacher&#39;, &#39;mammen&#39;, &#39;norm&#39; or &#39;webb&#39;. Optionally accepts a callable of one argument, `n`, the number of bootstraps iterations.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[np.ndarray, int]: Returns the arrays of weights and the number of bootstrap iterations</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="bp">self</span><span class="o">.</span><span class="n">weights_type</span> <span class="o">=</span> <span class="n">weights_type</span> 

    <span class="k">if</span> <span class="mi">2</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">N_G_bootcluster</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="ow">and</span> <span class="n">weights_type</span><span class="o">==</span><span class="s1">&#39;rademacher&#39;</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">full_enumeration</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="n">full_enumeration_warn</span><span class="o">=</span><span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span> 
      <span class="bp">self</span><span class="o">.</span><span class="n">full_enumeration</span> <span class="o">=</span> <span class="kc">False</span>
      <span class="n">full_enumeration_warn</span><span class="o">=</span><span class="kc">False</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">draw_weights</span><span class="p">(</span>
      <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights_type</span><span class="p">,</span> 
      <span class="n">full_enumeration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_enumeration</span><span class="p">,</span> 
      <span class="n">N_G_bootcluster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_G_bootcluster</span><span class="p">,</span>
      <span class="n">boot_iter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
      <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span>
    <span class="p">)</span>  

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">full_enumeration_warn</span>

  <span class="k">def</span> <span class="nf">get_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bootstrap_type</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
                 <span class="n">impose_null</span> <span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">adj</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> 
                 <span class="n">cluster_adj</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Run bootstrap and get scores for each variable</span>

<span class="sd">    Args:</span>
<span class="sd">        bootstrap_type (str): Determines which wild cluster bootstrap type should be run. Options are &quot;fnw11&quot;,&quot;11&quot;, &quot;13&quot;, &quot;31&quot; and &quot;33&quot; for the wild cluster bootstrap and &quot;11&quot; and &quot;31&quot; for the heteroskedastic bootstrap. For more information, see the details section. &quot;fnw11&quot; is the default for the cluster bootstrap, which runs a &quot;11&quot; type wild cluster bootstrap via the algorithm outlined in &quot;fast and wild&quot; (Roodman et al (2019)). &quot;11&quot; is the default for the heteroskedastic bootstrap.</span>
<span class="sd">        impose_null (bool): Controls if the null hypothesis is imposed on the bootstrap dgp or not. Null imposed (WCR) by default. If False, the null is not imposed (WCU)</span>
<span class="sd">        adj (bool, optional): Whether to adjust for small sample. Defaults to True.</span>
<span class="sd">        cluster_adj (bool, optional): Whether to do a cluster-robust small sample correction. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: The output array of scores of shape kxG</span>
<span class="sd">    &quot;&quot;&quot;</span>    

    <span class="k">if</span> <span class="n">bootstrap_type</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">crv_type</span> <span class="o">=</span> <span class="s2">&quot;crv1&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">ssc</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="n">adj</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ssc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssc</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">cluster_adj</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ssc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssc</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">G</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">G</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">bootstrap_type</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">crv_type</span> <span class="o">=</span> <span class="s2">&quot;crv3&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">ssc</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">G</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">G</span>

    <span class="n">bootstrap_type_x</span> <span class="o">=</span> <span class="n">bootstrap_type</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;x&#39;</span>

    <span class="k">if</span> <span class="n">impose_null</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap_type</span> <span class="o">=</span> <span class="s2">&quot;WCR&quot;</span> <span class="o">+</span> <span class="n">bootstrap_type_x</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap_type</span> <span class="o">=</span> <span class="s2">&quot;WCU&quot;</span> <span class="o">+</span> <span class="n">bootstrap_type_x</span>

    <span class="c1"># not needed for all types, but compute anyways</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXy</span>

    <span class="c1"># precompute required objects for computing scores &amp; vcov&#39;s</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;WCR3x&quot;</span><span class="p">]:</span> 

      <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span>
      <span class="n">X1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
      <span class="n">X1_list</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="n">tX1gX1g_list</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="n">tX1gyg_list</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="n">tXgX1g_list</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="n">tX1X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">tX1y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

      <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>
        <span class="c1">#ix = g = 1</span>
        <span class="n">X1_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X1</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootcluster</span> <span class="o">==</span> <span class="n">g</span><span class="p">)])</span>
        <span class="n">tX1gX1g_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">X1_list</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span> <span class="o">@</span> <span class="n">X1_list</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
        <span class="n">tX1gyg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">X1_list</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_list</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
        <span class="n">tXgX1g_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_list</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span> <span class="o">@</span>  <span class="n">X1_list</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
        <span class="n">tX1X1</span> <span class="o">=</span> <span class="n">tX1X1</span> <span class="o">+</span> <span class="n">tX1gX1g_list</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
        <span class="n">tX1y</span> <span class="o">=</span> <span class="n">tX1y</span> <span class="o">+</span> <span class="n">tX1gyg_list</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>

      <span class="n">beta_1g_tilde</span> <span class="o">=</span> <span class="p">[]</span>

      <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>
        <span class="n">beta_1g_tilde</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">tX1X1</span> <span class="o">-</span> <span class="n">tX1gX1g_list</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span> <span class="o">@</span> <span class="p">(</span><span class="n">tX1y</span> <span class="o">-</span> <span class="n">tX1gyg_list</span><span class="p">[</span><span class="n">ix</span><span class="p">]))</span>

      <span class="n">beta</span> <span class="o">=</span> <span class="n">beta_1g_tilde</span>
      <span class="n">M</span> <span class="o">=</span> <span class="n">tXgX1g_list</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;WCU3x&quot;</span><span class="p">]:</span> 

      <span class="n">beta_g_hat</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>
        <span class="n">beta_g_hat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tXX</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXgXg_list</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span> <span class="o">@</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tXy</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXgyg_list</span><span class="p">[</span><span class="n">ix</span><span class="p">]))</span>

      <span class="n">beta</span> <span class="o">=</span> <span class="n">beta_g_hat</span>
      <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXgXg_list</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;WCR1x&quot;</span><span class="p">]:</span> 

      <span class="n">A</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
      <span class="n">beta_tilde</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span> <span class="o">-</span> <span class="mi">0</span><span class="p">)</span>
      <span class="n">beta</span> <span class="o">=</span> <span class="n">beta_tilde</span>
      <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXgXg_list</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;WCU1x&quot;</span><span class="p">]:</span> 

      <span class="n">beta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span> 
      <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXgXg_list</span>

    <span class="c1"># compute scores based on tXgyg, M, beta</span>
    <span class="n">scores_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootstrap_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;WCR1x&quot;</span><span class="p">,</span> <span class="s2">&quot;WCU1x&quot;</span><span class="p">]):</span>

      <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>

        <span class="n">scores_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tXgyg_list</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">-</span> <span class="n">M</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">@</span> <span class="n">beta</span><span class="p">)</span>

    <span class="k">elif</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootstrap_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;WCR3x&quot;</span><span class="p">,</span> <span class="s2">&quot;WCU3x&quot;</span><span class="p">]):</span>

      <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>

        <span class="n">scores_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tXgyg_list</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">-</span> <span class="n">M</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">@</span> <span class="n">beta</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">scores_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scores_list</span><span class="p">))</span> <span class="c1"># k x G </span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scores_mat</span>


  <span class="k">def</span> <span class="nf">get_numer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>   
      <span class="c1"># Calculate the bootstrap numerator</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Cg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">scores_mat</span> 
      <span class="bp">self</span><span class="o">.</span><span class="n">numer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cg</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span>

  <span class="k">def</span> <span class="nf">get_denom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crv_type</span> <span class="o">==</span> <span class="s2">&quot;crv1&quot;</span><span class="p">:</span>

        <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">G</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">G</span><span class="p">))</span>

        <span class="c1"># numba optimization possible? </span>
        <span class="k">for</span> <span class="n">ixg</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>
          <span class="k">for</span> <span class="n">ixh</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>
            <span class="c1"># can be improved by replacing list calls with matrices; </span>
            <span class="n">H</span><span class="p">[</span><span class="n">ixg</span><span class="p">,</span><span class="n">ixh</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXgXg_list</span><span class="p">[</span><span class="n">ixg</span><span class="p">]</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">scores_mat</span><span class="p">[:,</span><span class="n">ixh</span><span class="p">]</span>

        <span class="c1"># now compute denominator</span>
        <span class="c1"># numba / cython / c++ optimization possible? Porting this part from </span>
        <span class="c1"># R to c++ gives good speed improvements</span>
        <span class="nd">@jit</span>
        <span class="k">def</span> <span class="nf">compute_denom</span><span class="p">(</span><span class="n">Cg</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">bootclustid</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">ssc</span><span class="p">):</span>

          <span class="n">denom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>

          <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
            <span class="n">Zg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ixg</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bootclustid</span><span class="p">):</span>
              <span class="n">vH</span> <span class="o">=</span> <span class="mi">0</span>
              <span class="k">for</span> <span class="n">ixh</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bootclustid</span><span class="p">):</span>
                <span class="n">vH</span> <span class="o">+=</span> <span class="n">v</span><span class="p">[</span><span class="n">ixh</span><span class="p">,</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">H</span><span class="p">[</span><span class="n">ixg</span><span class="p">,</span><span class="n">ixh</span><span class="p">]</span>
              <span class="n">Zg</span><span class="p">[</span><span class="n">ixg</span><span class="p">]</span> <span class="o">=</span> <span class="n">Cg</span><span class="p">[</span><span class="n">ixg</span><span class="p">]</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="n">ixg</span><span class="p">,</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">vH</span>

            <span class="c1"># todo: ssc</span>
            <span class="n">denom</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">ssc</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">Zg</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

          <span class="k">return</span> <span class="n">denom</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">denom</span> <span class="o">=</span> <span class="n">compute_denom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Cg</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">G</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssc</span><span class="p">)</span>

      <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">crv_type</span> <span class="o">==</span> <span class="s2">&quot;crv3&quot;</span><span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inv_tXX_tXgXg</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">inv_tXX_tXgXg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tXX</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXgXg_list</span><span class="p">[</span><span class="n">ix</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">denom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">):</span>

          <span class="n">scores_g_boot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">G</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>
          <span class="n">v_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[:,</span><span class="n">b</span><span class="p">]</span>

          <span class="k">for</span> <span class="n">ixg</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>

            <span class="n">scores_g_boot</span><span class="p">[</span><span class="n">ixg</span><span class="p">,:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scores_mat</span><span class="p">[:,</span><span class="n">ixg</span><span class="p">]</span> <span class="o">*</span> <span class="n">v_</span><span class="p">[</span><span class="n">ixg</span><span class="p">]</span>

          <span class="n">scores_boot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scores_g_boot</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
          <span class="n">delta_b_star</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="n">scores_boot</span>

          <span class="n">delta_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">G</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>

          <span class="k">for</span> <span class="n">ixg</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>

            <span class="n">score_diff</span> <span class="o">=</span> <span class="n">scores_boot</span> <span class="o">-</span> <span class="n">scores_g_boot</span><span class="p">[</span><span class="n">ixg</span><span class="p">,:]</span>
            <span class="n">delta_diff</span><span class="p">[</span><span class="n">ixg</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">(</span>

              <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inv_tXX_tXgXg</span><span class="p">[</span><span class="n">ixg</span><span class="p">]</span> <span class="o">@</span> <span class="n">score_diff</span> <span class="o">-</span> <span class="n">delta_b_star</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

              <span class="p">)</span>
          <span class="c1"># se&#39;s</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">denom</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssc</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">delta_diff</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span>


  <span class="k">def</span> <span class="nf">get_tboot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">t_boot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">numer</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">denom</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">get_vcov</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crv_type</span> <span class="o">==</span> <span class="s2">&quot;crv1&quot;</span><span class="p">:</span>

      <span class="n">meat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>
      <span class="k">for</span> <span class="n">ixg</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_list</span><span class="p">[</span><span class="n">ixg</span><span class="p">])</span> <span class="o">@</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y_list</span><span class="p">[</span><span class="n">ixg</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_list</span><span class="p">[</span><span class="n">ixg</span><span class="p">]</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span><span class="p">)</span>
        <span class="n">meat</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">vcov</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="n">meat</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">crv_type</span> <span class="o">==</span> <span class="s2">&quot;crv3&quot;</span><span class="p">:</span> 

      <span class="c1"># calculate leave-one out beta hat</span>
      <span class="n">beta_jack</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">G</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>
      <span class="k">for</span> <span class="n">ixg</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>
        <span class="n">beta_jack</span><span class="p">[</span><span class="n">ixg</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">(</span>
          <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tXX</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXgXg_list</span><span class="p">[</span><span class="n">ixg</span><span class="p">])</span> <span class="o">@</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tXy</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_list</span><span class="p">[</span><span class="n">ixg</span><span class="p">])</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_list</span><span class="p">[</span><span class="n">ixg</span><span class="p">])</span>
        <span class="p">)</span>

      <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;beta_hat&quot;</span><span class="p">):</span>
        <span class="n">beta_hat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXy</span>

      <span class="n">beta_center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span>

      <span class="n">vcov3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>
      <span class="k">for</span> <span class="n">ixg</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>
        <span class="n">beta_centered</span> <span class="o">=</span> <span class="n">beta_jack</span><span class="p">[</span><span class="n">ixg</span><span class="p">,:]</span> <span class="o">-</span> <span class="n">beta_center</span>
        <span class="n">vcov3</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">beta_centered</span><span class="p">,</span> <span class="n">beta_centered</span><span class="p">)</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">vcov</span> <span class="o">=</span>  <span class="n">vcov3</span>


  <span class="k">def</span> <span class="nf">get_tstat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="n">se</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ssc</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">vcov</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t_stat</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="p">)</span><span class="o">/</span> <span class="n">se</span>

  <span class="k">def</span> <span class="nf">get_pvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pval_type</span> <span class="o">=</span> <span class="s2">&quot;two-tailed&quot;</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">pval_type</span> <span class="o">==</span> <span class="s2">&quot;two-tailed&quot;</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">pvalue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_stat</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_boot</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">pval_type</span> <span class="o">==</span> <span class="s2">&quot;equal-tailed&quot;</span><span class="p">:</span>
      <span class="n">pl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_stat</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_boot</span><span class="p">)</span>
      <span class="n">ph</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_stat</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_boot</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">pvalue</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">ph</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">pval_type</span> <span class="o">==</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">pvalue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_stat</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_boot</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
      <span class="bp">self</span><span class="o">.</span><span class="n">pvalue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_stat</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_boot</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="wildboottest.wildboottest.WildboottestCL.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">cluster</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">bootcluster</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Initializes the Wild Cluster Bootstrap Class</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>X</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span>, <span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas">pd</span>.<span title="pandas.Series">Series</span>]</code>
          </td>
          <td><p>Exogeneous variable array or dataframe</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>Y</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span>, <span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas">pd</span>.<span title="pandas.Series">Series</span>]</code>
          </td>
          <td><p>Endogenous variable array or dataframe</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cluster</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span>, <span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas">pd</span>.<span title="pandas.Series">Series</span>]</code>
          </td>
          <td><p>Cluster array or dataframe</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>R</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span>, <span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span>]</code>
          </td>
          <td><p>Constraint matrix for running bootstrap</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>B</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>bootstrap iterations</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>bootcluster</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span>, <span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas">pd</span>.<span title="pandas.Series">Series</span>, None]</code>
          </td>
          <td><p>Sub-cluster array. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>seed</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[int, None]</code>
          </td>
          <td><p>Random seed for random weight types. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td><p>Raise if input arrays are lists</p></td>
        </tr>
        <tr>
          <td>
                <code><span title="wildboottest.wildboottest.TestMatrixNonConformabilityException">TestMatrixNonConformabilityException</span></code>
          </td>
          <td><p>Raise if constraint matrix shape does not conform to X</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>wildboottest\wildboottest.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span> <span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">],</span> 
             <span class="n">Y</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">],</span> 
             <span class="n">cluster</span> <span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">],</span> 
             <span class="n">R</span> <span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> 
             <span class="n">B</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
             <span class="n">bootcluster</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
             <span class="n">seed</span><span class="p">:</span>  <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;Initializes the Wild Cluster Bootstrap Class</span>

<span class="sd">  Args:</span>
<span class="sd">      X (Union[np.ndarray, pd.DataFrame, pd.Series]): Exogeneous variable array or dataframe</span>
<span class="sd">      Y (Union[np.ndarray, pd.DataFrame, pd.Series]): Endogenous variable array or dataframe</span>
<span class="sd">      cluster (Union[np.ndarray, pd.DataFrame, pd.Series]): Cluster array or dataframe</span>
<span class="sd">      R (Union[np.ndarray, pd.DataFrame]): Constraint matrix for running bootstrap</span>
<span class="sd">      B (int): bootstrap iterations</span>
<span class="sd">      bootcluster (Union[np.ndarray, pd.DataFrame, pd.Series, None], optional): Sub-cluster array. Defaults to None.</span>
<span class="sd">      seed (Union[int, None], optional): Random seed for random weight types. Defaults to None.</span>

<span class="sd">  Raises:</span>
<span class="sd">      TypeError: Raise if input arrays are lists</span>
<span class="sd">      TestMatrixNonConformabilityException: Raise if constraint matrix shape does not conform to X</span>
<span class="sd">  &quot;&quot;&quot;</span>    

  <span class="s2">&quot;Initialize the WildboottestCL class&quot;</span>
  <span class="c1">#assert bootstrap_type in [&#39;11&#39;, &#39;13&#39;, &#39;31&#39;, &#39;33&#39;]</span>
  <span class="c1">#assert impose_null in [True, False]</span>

  <span class="k">if</span> <span class="n">bootcluster</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
    <span class="n">bootcluster</span> <span class="o">=</span> <span class="n">cluster</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">cluster</span><span class="p">,</span> <span class="n">bootcluster</span><span class="p">]:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> cannot be a list&quot;</span><span class="p">)</span>

  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">values</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>

  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">values</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>

  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cluster</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">clustid</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cluster</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">values</span>
  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bootcluster</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span> <span class="o">=</span> <span class="n">bootcluster</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bootcluster</span> <span class="o">=</span> <span class="n">bootcluster</span><span class="o">.</span><span class="n">values</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">clustid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">bootcluster</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bootcluster</span> <span class="o">=</span> <span class="n">bootcluster</span>

  <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
    <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

  <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span><span class="p">)</span>

  <span class="bp">self</span><span class="o">.</span><span class="n">N_G_bootcluster</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">G</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clustid</span><span class="p">)</span>

  <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">B</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">R</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>

  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
    <span class="k">raise</span> <span class="n">TestMatrixNonConformabilityException</span><span class="p">(</span><span class="s2">&quot;The number of rows in the test matrix R, does not &quot;</span><span class="p">)</span>

  <span class="n">X_list</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">y_list</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">tXgXg_list</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">tXgyg_list</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">tXX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">))</span>
  <span class="n">tXy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>

  <span class="c1">#all_cluster = np.unique(bootcluster)</span>

  <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">:</span>

    <span class="c1"># split X and Y by (boot)cluster</span>
    <span class="n">X_g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootcluster</span> <span class="o">==</span> <span class="n">g</span><span class="p">)]</span>
    <span class="n">Y_g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootcluster</span> <span class="o">==</span> <span class="n">g</span><span class="p">)]</span>
    <span class="n">tXgXg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">X_g</span><span class="p">)</span> <span class="o">@</span> <span class="n">X_g</span>
    <span class="n">tXgyg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">X_g</span><span class="p">)</span> <span class="o">@</span> <span class="n">Y_g</span>
    <span class="n">X_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_g</span><span class="p">)</span>
    <span class="n">y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y_g</span><span class="p">)</span>
    <span class="n">tXgXg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tXgXg</span><span class="p">)</span>
    <span class="n">tXgyg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tXgyg</span><span class="p">)</span>
    <span class="n">tXX</span> <span class="o">+=</span> <span class="n">tXgXg</span>
    <span class="n">tXy</span> <span class="o">+=</span> <span class="n">tXgyg</span>

  <span class="bp">self</span><span class="o">.</span><span class="n">X_list</span> <span class="o">=</span> <span class="n">X_list</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">Y_list</span> <span class="o">=</span> <span class="n">y_list</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">tXgXg_list</span> <span class="o">=</span> <span class="n">tXgXg_list</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">tXgyg_list</span> <span class="o">=</span> <span class="n">tXgyg_list</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">tXX</span> <span class="o">=</span> <span class="n">tXX</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">tXy</span> <span class="o">=</span> <span class="n">tXy</span>

  <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">tXX</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">RtXXinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="wildboottest.wildboottest.WildboottestCL.get_scores" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_scores</span><span class="p">(</span><span class="n">bootstrap_type</span><span class="p">,</span> <span class="n">impose_null</span><span class="p">,</span> <span class="n">adj</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cluster_adj</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Run bootstrap and get scores for each variable</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>bootstrap_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Determines which wild cluster bootstrap type should be run. Options are "fnw11","11", "13", "31" and "33" for the wild cluster bootstrap and "11" and "31" for the heteroskedastic bootstrap. For more information, see the details section. "fnw11" is the default for the cluster bootstrap, which runs a "11" type wild cluster bootstrap via the algorithm outlined in "fast and wild" (Roodman et al (2019)). "11" is the default for the heteroskedastic bootstrap.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>impose_null</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Controls if the null hypothesis is imposed on the bootstrap dgp or not. Null imposed (WCR) by default. If False, the null is not imposed (WCU)</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>adj</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to adjust for small sample. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>cluster_adj</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to do a cluster-robust small sample correction. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>np.ndarray: The output array of scores of shape kxG</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>wildboottest\wildboottest.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bootstrap_type</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
               <span class="n">impose_null</span> <span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">adj</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> 
               <span class="n">cluster_adj</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;Run bootstrap and get scores for each variable</span>

<span class="sd">  Args:</span>
<span class="sd">      bootstrap_type (str): Determines which wild cluster bootstrap type should be run. Options are &quot;fnw11&quot;,&quot;11&quot;, &quot;13&quot;, &quot;31&quot; and &quot;33&quot; for the wild cluster bootstrap and &quot;11&quot; and &quot;31&quot; for the heteroskedastic bootstrap. For more information, see the details section. &quot;fnw11&quot; is the default for the cluster bootstrap, which runs a &quot;11&quot; type wild cluster bootstrap via the algorithm outlined in &quot;fast and wild&quot; (Roodman et al (2019)). &quot;11&quot; is the default for the heteroskedastic bootstrap.</span>
<span class="sd">      impose_null (bool): Controls if the null hypothesis is imposed on the bootstrap dgp or not. Null imposed (WCR) by default. If False, the null is not imposed (WCU)</span>
<span class="sd">      adj (bool, optional): Whether to adjust for small sample. Defaults to True.</span>
<span class="sd">      cluster_adj (bool, optional): Whether to do a cluster-robust small sample correction. Defaults to True.</span>

<span class="sd">  Returns:</span>
<span class="sd">      np.ndarray: The output array of scores of shape kxG</span>
<span class="sd">  &quot;&quot;&quot;</span>    

  <span class="k">if</span> <span class="n">bootstrap_type</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">crv_type</span> <span class="o">=</span> <span class="s2">&quot;crv1&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ssc</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">adj</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">ssc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssc</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cluster_adj</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">ssc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssc</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">G</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">G</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
  <span class="k">elif</span> <span class="n">bootstrap_type</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">crv_type</span> <span class="o">=</span> <span class="s2">&quot;crv3&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ssc</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">G</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">G</span>

  <span class="n">bootstrap_type_x</span> <span class="o">=</span> <span class="n">bootstrap_type</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;x&#39;</span>

  <span class="k">if</span> <span class="n">impose_null</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap_type</span> <span class="o">=</span> <span class="s2">&quot;WCR&quot;</span> <span class="o">+</span> <span class="n">bootstrap_type_x</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap_type</span> <span class="o">=</span> <span class="s2">&quot;WCU&quot;</span> <span class="o">+</span> <span class="n">bootstrap_type_x</span>

  <span class="c1"># not needed for all types, but compute anyways</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXy</span>

  <span class="c1"># precompute required objects for computing scores &amp; vcov&#39;s</span>
  <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;WCR3x&quot;</span><span class="p">]:</span> 

    <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span>
    <span class="n">X1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">X1_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tX1gX1g_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tX1gyg_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tXgX1g_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tX1X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">tX1y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>
      <span class="c1">#ix = g = 1</span>
      <span class="n">X1_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X1</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootcluster</span> <span class="o">==</span> <span class="n">g</span><span class="p">)])</span>
      <span class="n">tX1gX1g_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">X1_list</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span> <span class="o">@</span> <span class="n">X1_list</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
      <span class="n">tX1gyg_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">X1_list</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y_list</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
      <span class="n">tXgX1g_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_list</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span> <span class="o">@</span>  <span class="n">X1_list</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
      <span class="n">tX1X1</span> <span class="o">=</span> <span class="n">tX1X1</span> <span class="o">+</span> <span class="n">tX1gX1g_list</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
      <span class="n">tX1y</span> <span class="o">=</span> <span class="n">tX1y</span> <span class="o">+</span> <span class="n">tX1gyg_list</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>

    <span class="n">beta_1g_tilde</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>
      <span class="n">beta_1g_tilde</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">tX1X1</span> <span class="o">-</span> <span class="n">tX1gX1g_list</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span> <span class="o">@</span> <span class="p">(</span><span class="n">tX1y</span> <span class="o">-</span> <span class="n">tX1gyg_list</span><span class="p">[</span><span class="n">ix</span><span class="p">]))</span>

    <span class="n">beta</span> <span class="o">=</span> <span class="n">beta_1g_tilde</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">tXgX1g_list</span>

  <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;WCU3x&quot;</span><span class="p">]:</span> 

    <span class="n">beta_g_hat</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>
      <span class="n">beta_g_hat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tXX</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXgXg_list</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span> <span class="o">@</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tXy</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXgyg_list</span><span class="p">[</span><span class="n">ix</span><span class="p">]))</span>

    <span class="n">beta</span> <span class="o">=</span> <span class="n">beta_g_hat</span>
    <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXgXg_list</span>

  <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;WCR1x&quot;</span><span class="p">]:</span> 

    <span class="n">A</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
    <span class="n">beta_tilde</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span> <span class="o">-</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">beta_tilde</span>
    <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXgXg_list</span>

  <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;WCU1x&quot;</span><span class="p">]:</span> 

    <span class="n">beta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span> 
    <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXgXg_list</span>

  <span class="c1"># compute scores based on tXgyg, M, beta</span>
  <span class="n">scores_list</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootstrap_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;WCR1x&quot;</span><span class="p">,</span> <span class="s2">&quot;WCU1x&quot;</span><span class="p">]):</span>

    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>

      <span class="n">scores_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tXgyg_list</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">-</span> <span class="n">M</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">@</span> <span class="n">beta</span><span class="p">)</span>

  <span class="k">elif</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootstrap_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;WCR3x&quot;</span><span class="p">,</span> <span class="s2">&quot;WCU3x&quot;</span><span class="p">]):</span>

    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bootclustid</span><span class="p">):</span>

      <span class="n">scores_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tXgyg_list</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">-</span> <span class="n">M</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">@</span> <span class="n">beta</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>

  <span class="bp">self</span><span class="o">.</span><span class="n">scores_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scores_list</span><span class="p">))</span> <span class="c1"># k x G </span>

  <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scores_mat</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="wildboottest.wildboottest.WildboottestCL.get_weights" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_weights</span><span class="p">(</span><span class="n">weights_type</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function for getting weights for bootstrapping.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>weights_type</code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[str, <span title="typing.Callable">Callable</span>]</code>
          </td>
          <td><p>The distribution to be used. Accepts Either 'rademacher', 'mammen', 'norm' or 'webb'. Optionally accepts a callable of one argument, <code>n</code>, the number of bootstraps iterations.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[<span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span>, int, bool]</code>
          </td>
          <td><p>Tuple[np.ndarray, int]: Returns the arrays of weights and the number of bootstrap iterations</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>wildboottest\wildboottest.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
  <span class="sd">&quot;&quot;&quot;Function for getting weights for bootstrapping.</span>

<span class="sd">  Args:</span>
<span class="sd">      weights_type (Tuple[str, Callable]): The distribution to be used. Accepts Either &#39;rademacher&#39;, &#39;mammen&#39;, &#39;norm&#39; or &#39;webb&#39;. Optionally accepts a callable of one argument, `n`, the number of bootstraps iterations.</span>

<span class="sd">  Returns:</span>
<span class="sd">      Tuple[np.ndarray, int]: Returns the arrays of weights and the number of bootstrap iterations</span>
<span class="sd">  &quot;&quot;&quot;</span>    
  <span class="bp">self</span><span class="o">.</span><span class="n">weights_type</span> <span class="o">=</span> <span class="n">weights_type</span> 

  <span class="k">if</span> <span class="mi">2</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">N_G_bootcluster</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="ow">and</span> <span class="n">weights_type</span><span class="o">==</span><span class="s1">&#39;rademacher&#39;</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">full_enumeration</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">full_enumeration_warn</span><span class="o">=</span><span class="kc">True</span>
  <span class="k">else</span><span class="p">:</span> 
    <span class="bp">self</span><span class="o">.</span><span class="n">full_enumeration</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">full_enumeration_warn</span><span class="o">=</span><span class="kc">False</span>

  <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">draw_weights</span><span class="p">(</span>
    <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights_type</span><span class="p">,</span> 
    <span class="n">full_enumeration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_enumeration</span><span class="p">,</span> 
    <span class="n">N_G_bootcluster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N_G_bootcluster</span><span class="p">,</span>
    <span class="n">boot_iter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">,</span>
    <span class="n">rng</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rng</span>
  <span class="p">)</span>  

  <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">full_enumeration_warn</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="wild-non-clustered-bootstrap-class">Wild (non-clustered) Bootstrap Class</h2>


<div class="doc doc-object doc-class">


<a id="wildboottest.wildboottest.WildboottestHC"></a>
  <div class="doc doc-contents first">

  
      <p>Create an object of WildboottestHC and get p-value by successively applying
methods in the following way: </p>

<details class="example">
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>import numpy as np
from wildboottest.wildboottest import WildboottestHC
np.random.seed(12312312)
N = 1000
k = 3
G = 10
X = np.random.normal(0, 1, N * k).reshape((N,k))
beta = np.random.normal(0,1,k)
beta[0] = 0.005
u = np.random.normal(0,1,N)
Y = 1 + X @ beta + u
R = np.array([1, 0, 0])
r = 0
B = 999
wb = WildboottestHC(X = X, Y = Y, R = R, r = 0, B = B)
wb.get_adjustments(bootstrap_type = '11')
wb.get_uhat(impose_null = True)
wb.get_tboot(weights_type = "rademacher")
wb.get_tstat()
wb.get_pvalue()</p>
</blockquote>
</blockquote>
</blockquote>
</details>

        <details class="quote">
          <summary>Source code in <code>wildboottest\wildboottest.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">WildboottestHC</span><span class="p">:</span> 

    <span class="sd">&quot;&quot;&quot;Create an object of WildboottestHC and get p-value by successively applying</span>
<span class="sd">    methods in the following way: </span>

<span class="sd">    Example:</span>

<span class="sd">      &gt;&gt;&gt; import numpy as np</span>
<span class="sd">      &gt;&gt;&gt; from wildboottest.wildboottest import WildboottestHC</span>
<span class="sd">      &gt;&gt;&gt; np.random.seed(12312312)</span>
<span class="sd">      &gt;&gt;&gt; N = 1000</span>
<span class="sd">      &gt;&gt;&gt; k = 3</span>
<span class="sd">      &gt;&gt;&gt; G = 10</span>
<span class="sd">      &gt;&gt;&gt; X = np.random.normal(0, 1, N * k).reshape((N,k))</span>
<span class="sd">      &gt;&gt;&gt; beta = np.random.normal(0,1,k)</span>
<span class="sd">      &gt;&gt;&gt; beta[0] = 0.005</span>
<span class="sd">      &gt;&gt;&gt; u = np.random.normal(0,1,N)</span>
<span class="sd">      &gt;&gt;&gt; Y = 1 + X @ beta + u</span>
<span class="sd">      &gt;&gt;&gt; R = np.array([1, 0, 0])</span>
<span class="sd">      &gt;&gt;&gt; r = 0</span>
<span class="sd">      &gt;&gt;&gt; B = 999</span>
<span class="sd">      &gt;&gt;&gt; wb = WildboottestHC(X = X, Y = Y, R = R, r = 0, B = B)</span>
<span class="sd">      &gt;&gt;&gt; wb.get_adjustments(bootstrap_type = &#39;11&#39;)</span>
<span class="sd">      &gt;&gt;&gt; wb.get_uhat(impose_null = True)</span>
<span class="sd">      &gt;&gt;&gt; wb.get_tboot(weights_type = &quot;rademacher&quot;)</span>
<span class="sd">      &gt;&gt;&gt; wb.get_tstat()</span>
<span class="sd">      &gt;&gt;&gt; wb.get_pvalue()  </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span> <span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">],</span> 
          <span class="n">Y</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">],</span> 
          <span class="n">R</span> <span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> 
          <span class="n">r</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
          <span class="n">B</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
          <span class="n">seed</span><span class="p">:</span>  <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="sd">&quot;&quot;&quot;Initializes the Heteroskedastic Wild Bootstrap Class</span>

<span class="sd">        Args:</span>
<span class="sd">          X (Union[np.ndarray, pd.DataFrame, pd.Series]): Exogeneous variable array or dataframe</span>
<span class="sd">          Y (Union[np.ndarray, pd.DataFrame, pd.Series]): Endogenous variable array or dataframe</span>
<span class="sd">          R (Union[np.ndarray, pd.DataFrame]): Constraint matrix for running bootstrap</span>
<span class="sd">          B (int): bootstrap iterations</span>
<span class="sd">          seed (Union[int, None], optional): Random seed for random weight types. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">          TypeError: Raise if input arrays are lists</span>
<span class="sd">          TestMatrixNonConformabilityException: Raise if constraint matrix shape does not conform to X</span>
<span class="sd">        &quot;&quot;&quot;</span>    

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">]:</span>
          <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> cannot be a list&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>

        <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
          <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">B</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">R</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
          <span class="k">raise</span> <span class="n">TestMatrixNonConformabilityException</span><span class="p">(</span><span class="s2">&quot;The number of rows in the test matrix R, does not &quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_adjustments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bootstrap_type</span><span class="p">):</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Raises: </span>
<span class="sd">          TestBootstrapTypeException: If non-appropriate bootstrap types are selected</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">bootstrap_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="s1">&#39;21&#39;</span><span class="p">,</span> <span class="s1">&#39;31&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">TestBootstrapTypeException</span><span class="p">(</span><span class="s2">&quot;For the heteroskedastic (i.e. non-clustered) wild bootstrap, only types &#39;11&#39;, &#39;21&#39; and &#39;31&#39; are supported.&quot;</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resid_multiplier_boot</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">small_sample_correction</span> <span class="o">=</span> <span class="n">_adjust_scores</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span><span class="p">,</span> <span class="n">bootstrap_type</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">get_uhat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">impose_null</span> <span class="p">:</span> <span class="nb">bool</span><span class="p">):</span> 

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Raises: </span>
<span class="sd">          TestHCImposeNullException: If the null is not imposed on the bootstrap dgp</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">impose_null</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span> 
          <span class="k">raise</span> <span class="n">TestHCImposeNullException</span><span class="p">(</span><span class="s1">&#39;For the heteroskedastic bootstrap, the null needs to be imposed.&#39;</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">tXy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXy</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">uhat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span>

        <span class="k">if</span> <span class="n">impose_null</span><span class="p">:</span> 
          <span class="bp">self</span><span class="o">.</span><span class="n">impose_null</span> <span class="o">=</span> <span class="kc">True</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">beta_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span><span class="c1">#self.uhat_r = self.Y - self.beta_r </span>
          <span class="bp">self</span><span class="o">.</span><span class="n">uhat_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_r</span> 
          <span class="bp">self</span><span class="o">.</span><span class="n">uhat2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uhat_r</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">resid_multiplier_boot</span>
        <span class="k">else</span><span class="p">:</span> 
          <span class="bp">self</span><span class="o">.</span><span class="n">impose_null</span> <span class="o">=</span> <span class="kc">False</span>    
          <span class="bp">self</span><span class="o">.</span><span class="n">uhat2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uhat</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">resid_multiplier_boot</span>

    <span class="k">def</span> <span class="nf">get_tboot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]):</span>

        <span class="k">if</span> <span class="n">weights_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;rademacher&#39;</span><span class="p">,</span> <span class="s1">&#39;norm&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">TestHCWeightsException</span><span class="p">(</span><span class="s2">&quot;For the heteroskedastic bootstrap, only weight tyes &#39;rademacher&#39; and &#39;normal&#39; are supported, but you provided &#39;&quot;</span> <span class="o">+</span> <span class="n">weights_type</span> <span class="o">+</span> <span class="s2">&quot;&#39; .&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights_type</span> <span class="o">=</span> <span class="n">weights_type</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tXXinvX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>  

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">impose_null</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
          <span class="n">beta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_r</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span> 
          <span class="n">beta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="n">yhat</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">@</span> <span class="n">beta</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

        <span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RXXinvX_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">R</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c1">#RXXinv_2 = np.power(np.transpose(R) @ self.tXXinv, 2)</span>

        <span class="c1">#@jit</span>
        <span class="k">def</span> <span class="nf">_run_hc_bootstrap</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">weights_type</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">yhat</span><span class="p">,</span> <span class="n">uhat2</span><span class="p">,</span> <span class="n">tXXinv</span><span class="p">,</span> <span class="n">RXXinvX_2</span><span class="p">,</span> <span class="n">Rt</span><span class="p">,</span> <span class="n">small_sample_correction</span><span class="p">,</span> <span class="n">rng</span><span class="p">):</span>

            <span class="n">t_boot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
            <span class="n">tXXinvX</span> <span class="o">=</span> <span class="n">tXXinv</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
            <span class="c1"># create weights vector. mammen weights not supported via numba</span>
                <span class="n">v</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">draw_weights</span><span class="p">(</span>
                          <span class="n">t</span> <span class="o">=</span> <span class="n">weights_type</span><span class="p">,</span> 
                          <span class="n">full_enumeration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
                          <span class="n">N_G_bootcluster</span> <span class="o">=</span> <span class="n">N</span><span class="p">,</span>
                          <span class="n">boot_iter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                          <span class="n">rng</span><span class="o">=</span><span class="n">rng</span>
                        <span class="p">)</span>

                <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

                <span class="n">uhat_boot</span> <span class="o">=</span> <span class="n">uhat2</span> <span class="o">*</span> <span class="n">v</span>
                <span class="n">yhat_boot</span> <span class="o">=</span> <span class="n">yhat</span> <span class="o">+</span> <span class="n">uhat_boot</span>
                <span class="n">beta_boot</span> <span class="o">=</span> <span class="n">tXXinvX</span>  <span class="o">@</span> <span class="n">yhat_boot</span>
                <span class="n">resid_boot</span> <span class="o">=</span> <span class="n">yhat_boot</span> <span class="o">-</span> <span class="n">X</span> <span class="o">@</span> <span class="n">beta_boot</span>
                <span class="n">cov_v</span> <span class="o">=</span> <span class="n">small_sample_correction</span> <span class="o">*</span> <span class="n">RXXinvX_2</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">resid_boot</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">t_boot</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Rt</span> <span class="o">@</span> <span class="n">beta_boot</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov_v</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">t_boot</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">t_boot</span> <span class="o">=</span> <span class="n">_run_hc_bootstrap</span><span class="p">(</span>
            <span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> 
            <span class="n">weights_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights_type</span><span class="p">,</span> 
            <span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> 
            <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span>
            <span class="n">yhat</span> <span class="o">=</span> <span class="n">yhat</span><span class="p">,</span> 
            <span class="n">uhat2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uhat2</span><span class="p">,</span>
            <span class="n">tXXinv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span><span class="p">,</span> 
            <span class="n">RXXinvX_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RXXinvX_2</span><span class="p">,</span> 
            <span class="n">Rt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">R</span><span class="p">),</span> 
            <span class="n">small_sample_correction</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">small_sample_correction</span><span class="p">,</span> 
            <span class="n">rng</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span>
          <span class="p">)</span>        

    <span class="k">def</span> <span class="nf">get_tstat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">cov</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">small_sample_correction</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">RXXinvX_2</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uhat</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_stat</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_pvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pval_type</span> <span class="o">=</span> <span class="s2">&quot;two-tailed&quot;</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">pval_type</span> <span class="o">==</span> <span class="s2">&quot;two-tailed&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pvalue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_stat</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_boot</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pval_type</span> <span class="o">==</span> <span class="s2">&quot;equal-tailed&quot;</span><span class="p">:</span>
            <span class="n">pl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_stat</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_boot</span><span class="p">)</span>
            <span class="n">ph</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_stat</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_boot</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pvalue</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">ph</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">pval_type</span> <span class="o">==</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pvalue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_stat</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_boot</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">pvalue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t_stat</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_boot</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="wildboottest.wildboottest.WildboottestHC.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Initializes the Heteroskedastic Wild Bootstrap Class</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>X</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span>, <span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas">pd</span>.<span title="pandas.Series">Series</span>]</code>
          </td>
          <td><p>Exogeneous variable array or dataframe</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>Y</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span>, <span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas">pd</span>.<span title="pandas.Series">Series</span>]</code>
          </td>
          <td><p>Endogenous variable array or dataframe</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>R</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span>, <span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span>]</code>
          </td>
          <td><p>Constraint matrix for running bootstrap</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>B</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>bootstrap iterations</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>seed</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[int, None]</code>
          </td>
          <td><p>Random seed for random weight types. Defaults to None.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td><p>Raise if input arrays are lists</p></td>
        </tr>
        <tr>
          <td>
                <code><span title="wildboottest.wildboottest.TestMatrixNonConformabilityException">TestMatrixNonConformabilityException</span></code>
          </td>
          <td><p>Raise if constraint matrix shape does not conform to X</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>wildboottest\wildboottest.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span> <span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">],</span> 
      <span class="n">Y</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">],</span> 
      <span class="n">R</span> <span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> 
      <span class="n">r</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
      <span class="n">B</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
      <span class="n">seed</span><span class="p">:</span>  <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="sd">&quot;&quot;&quot;Initializes the Heteroskedastic Wild Bootstrap Class</span>

<span class="sd">    Args:</span>
<span class="sd">      X (Union[np.ndarray, pd.DataFrame, pd.Series]): Exogeneous variable array or dataframe</span>
<span class="sd">      Y (Union[np.ndarray, pd.DataFrame, pd.Series]): Endogenous variable array or dataframe</span>
<span class="sd">      R (Union[np.ndarray, pd.DataFrame]): Constraint matrix for running bootstrap</span>
<span class="sd">      B (int): bootstrap iterations</span>
<span class="sd">      seed (Union[int, None], optional): Random seed for random weight types. Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">      TypeError: Raise if input arrays are lists</span>
<span class="sd">      TestMatrixNonConformabilityException: Raise if constraint matrix shape does not conform to X</span>
<span class="sd">    &quot;&quot;&quot;</span>    

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">]:</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> cannot be a list&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">values</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">values</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span>

    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
      <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">B</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">R</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
      <span class="k">raise</span> <span class="n">TestMatrixNonConformabilityException</span><span class="p">(</span><span class="s2">&quot;The number of rows in the test matrix R, does not &quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="wildboottest.wildboottest.WildboottestHC.get_adjustments" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_adjustments</span><span class="p">(</span><span class="n">bootstrap_type</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Raises: 
  TestBootstrapTypeException: If non-appropriate bootstrap types are selected</p>

      <details class="quote">
        <summary>Source code in <code>wildboottest\wildboottest.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_adjustments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bootstrap_type</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Raises: </span>
<span class="sd">      TestBootstrapTypeException: If non-appropriate bootstrap types are selected</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">bootstrap_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;11&#39;</span><span class="p">,</span> <span class="s1">&#39;21&#39;</span><span class="p">,</span> <span class="s1">&#39;31&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="n">TestBootstrapTypeException</span><span class="p">(</span><span class="s2">&quot;For the heteroskedastic (i.e. non-clustered) wild bootstrap, only types &#39;11&#39;, &#39;21&#39; and &#39;31&#39; are supported.&quot;</span><span class="p">)</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">resid_multiplier_boot</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">small_sample_correction</span> <span class="o">=</span> <span class="n">_adjust_scores</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span><span class="p">,</span> <span class="n">bootstrap_type</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="wildboottest.wildboottest.WildboottestHC.get_uhat" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_uhat</span><span class="p">(</span><span class="n">impose_null</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Raises: 
  TestHCImposeNullException: If the null is not imposed on the bootstrap dgp</p>

      <details class="quote">
        <summary>Source code in <code>wildboottest\wildboottest.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_uhat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">impose_null</span> <span class="p">:</span> <span class="nb">bool</span><span class="p">):</span> 

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Raises: </span>
<span class="sd">      TestHCImposeNullException: If the null is not imposed on the bootstrap dgp</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">impose_null</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span> 
      <span class="k">raise</span> <span class="n">TestHCImposeNullException</span><span class="p">(</span><span class="s1">&#39;For the heteroskedastic bootstrap, the null needs to be imposed.&#39;</span><span class="p">)</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">tXy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXy</span> 
    <span class="bp">self</span><span class="o">.</span><span class="n">uhat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span>

    <span class="k">if</span> <span class="n">impose_null</span><span class="p">:</span> 
      <span class="bp">self</span><span class="o">.</span><span class="n">impose_null</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">beta_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">tXXinv</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_hat</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span><span class="c1">#self.uhat_r = self.Y - self.beta_r </span>
      <span class="bp">self</span><span class="o">.</span><span class="n">uhat_r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_r</span> 
      <span class="bp">self</span><span class="o">.</span><span class="n">uhat2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uhat_r</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">resid_multiplier_boot</span>
    <span class="k">else</span><span class="p">:</span> 
      <span class="bp">self</span><span class="o">.</span><span class="n">impose_null</span> <span class="o">=</span> <span class="kc">False</span>    
      <span class="bp">self</span><span class="o">.</span><span class="n">uhat2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uhat</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">resid_multiplier_boot</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href=".." class="btn btn-neutral float-left" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../weights/" class="btn btn-neutral float-right" title="Weighting">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href=".." style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../weights/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
